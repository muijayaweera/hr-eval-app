<!-- evaluation_3month.html -->
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>3 Month Evaluation</title>
  <link rel="stylesheet" href="eval3month.css" />
</head>
<body>

  <h1>3 Month Evaluation</h1>

  <div class="section-title">Employee Details</div>

  <div class="card">
    <div class="employee-details">
      <div class="form-group"><label>Employee Name :</label><input type="text" placeholder="Enter name"/></div>
      <div class="form-group"><label>Date Joined :</label><input type="date"/></div>
      <div class="form-group"><label>EPF Number :</label><input type="text"/></div>
      <div class="form-group"><label>Location / Dept :</label><input type="text"/></div>
      <div class="form-group"><label>Designation :</label><input type="text"/></div>
      <div class="form-group"><label>Period Covered :</label><input type="text"/></div>
      <div class="form-group"><label>Current Salary :</label><input type="text"/></div>
      <div class="form-group"><label>Supervisor :</label><input type="text"/></div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <div class="traits-section">
    <div class="section-title">Factors/ Skills/ Traits</div>

    <!-- Header Row -->
    <div class="trait-row header-row">
      <div class="trait-col">Statement</div>
      <div class="trait-col center">Weightage</div>
      <div class="trait-col center">Rating by HOD</div>
    </div>

    <!-- Traits Section -->
    <div class="trait-box">
      <!-- CATEGORY: Job Knowledge -->
      <div class="trait-title">Job Knowledge</div>
      <div class="trait-row">
        <div class="trait-col">The levels of absorption of duties & responsibilities about the job and work with minimal supervision.</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Can be relied upon to meet challenges and deliver on time, follow up assigned work</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <!-- CATEGORY: Technical Knowledge -->
      <div class="trait-title">Technical Knowledge</div>
      <div class="trait-row">
        <div class="trait-col">Fair knowledge about technical aspects.</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Seeks/ applies innovative and relevant techniques</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Uses technical knowledge to improve processes, procedures, and operations</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <!-- CATEGORY: Attitude Towards Work -->
      <div class="trait-title">Attitude Towards Work</div>
      <div class="trait-row">
        <div class="trait-col">Positive attitude, able to execute any job assigned</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Highly motivated, diplomatic and handles matters well</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Goes beyond the call, eager to learn</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Open minded, receptive to feedback, calm under pressure</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <!-- CATEGORY: Honesty & Integrity -->
      <div class="trait-title">Honesty & Integrity</div>
      <div class="trait-row">
        <div class="trait-col">Displays high integrity and honesty in actions</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Admits mistakes genuinely, reliable and dependable</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Ensures consistency between actions and words</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <!-- CATEGORY: Team Spirit -->
      <div class="trait-title">Team Spirit</div>
      <div class="trait-row">
        <div class="trait-col">Willing to support superiors & coworkers</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>
      <div class="trait-row">
        <div class="trait-col">Works well in team, maintains friendly relationships</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <!-- Remaining categories follow same pattern -->
      <div class="trait-title">Customer Service Orientation</div>
      <div class="trait-row">
        <div class="trait-col">Takes effort to satisfy customers consistently</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <div class="trait-title">Personal Organization & Appearance</div>
      <div class="trait-row">
        <div class="trait-col">Well-organized, prioritizes tasks, tidy appearance</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <div class="trait-title">Attendance & Punctuality</div>
      <div class="trait-row">
        <div class="trait-col">Regular, punctual and eager to work</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

      <div class="trait-title">Communication</div>
      <div class="trait-row">
        <div class="trait-col">Proactive, updated, shares information effectively</div>
        <div class="trait-col center">10</div>
        <div class="trait-col center">
          <input 
          type="number" 
          name="rating1" 
          min="1" 
          max="10" 
          oninput="if(this.value > 10) this.value = 10; if(this.value < 1) this.value = 1;">
        </div>
      </div>

    </div>
  </div>


<button onclick="generateLetter()">Generate Evaluation Letter</button>

<div id="evaluationLetter" style="margin-top: 30px; white-space: pre-wrap; font-family: 'Poppins', sans-serif;"></div>

<script>

  // Get inputs
const personalInputs = document.querySelectorAll(".employee-details input");
const ratingInputs = document.querySelectorAll(".rating");
const toast = document.getElementById("toast"); 

function showToast(message) {
  toast.textContent = message;
  toast.classList.add("show");
  setTimeout(() => {
    toast.classList.remove("show");
  }, 3000);
}

// Replace your previous ratingInputs click listeners with this:
ratingInputs.forEach(input => {
  input.addEventListener("click", function(e) {
    if (input.disabled) {
      e.preventDefault();
      showToast("⚠ Please complete all personal details before entering ratings.");
    }
  });
});



// Disable ratings initially
ratingInputs.forEach(input => input.readOnly = true);


// Function to check if personal details are filled
function checkPersonalDetails() {
  let allFilled = true;
  personalInputs.forEach(input => {
    if (!input.value.trim()) {
      allFilled = false;
    }
  });
  console.log("All personal filled? ", allFilled);



  ratingInputs.forEach(input => {
  input.addEventListener("click", function(e) {
    console.log("Clicked rating, disabled? ", input.disabled);
    if (input.disabled) {
      e.preventDefault();
      showToast("⚠ Please complete all personal details before entering ratings.");
    }
  });
});

}


// Listen for changes in personal details
personalInputs.forEach(input => {
  input.addEventListener("input", checkPersonalDetails);
});


function generateLetter() {
  const ratings = document.querySelectorAll(".rating");
  let total = 0;
  let count = 0;

  ratings.forEach(input => {
    const val = parseFloat(input.value);
    if (!isNaN(val)) {
      total += val;
      count++;
    }
  });

  const average = (total / count).toFixed(2);

  // Grab employee details
  const employeeName = document.querySelector('input[placeholder="Enter name"]').value || "the employee";
  const dateJoined = document.querySelector('input[type="date"]').value || "N/A";
  const epf = document.querySelectorAll(".employee-details input")[2].value || "N/A";
  const dept = document.querySelectorAll(".employee-details input")[3].value || "N/A";
  const designation = document.querySelectorAll(".employee-details input")[4].value || "N/A";
  const periodCovered = document.querySelectorAll(".employee-details input")[5].value || "N/A";
  const salary = document.querySelectorAll(".employee-details input")[6].value || "N/A";
  const supervisor = document.querySelectorAll(".employee-details input")[7].value || "N/A";

  let performanceLevel = "";
  let comment = "";

  if (average >= 9) {
    performanceLevel = "Excellent";
    comment = "The employee has demonstrated exceptional performance in all key areas and has exceeded expectations consistently.";
  } else if (average >= 7) {
    performanceLevel = "Good";
    comment = "The employee has met expectations in most areas and has shown strong potential and consistency in performance.";
  } else if (average >= 5) {
    performanceLevel = "Satisfactory";
    comment = "The employee has shown satisfactory performance with room for improvement in several areas.";
  } else {
    performanceLevel = "Needs Improvement";
    comment = "The employee’s performance has not met expectations and significant improvement is required.";
  }

  // Build the letter with employee details + evaluation summary
  const letter = 
`Employee Evaluation Letter

Name: ${employeeName}
Date Joined: ${dateJoined}
EPF Number: ${epf}
Department/Location: ${dept}
Designation: ${designation}
Period Covered: ${periodCovered}
Current Salary: ${salary}
Supervisor: ${supervisor}

Dear ${employeeName},

Following the 3-month performance evaluation, we are pleased to share your overall performance summary.

Total Score: ${total} / ${count * 10}
Average Score: ${average} / 10
Performance Level: ${performanceLevel}

Summary:
${comment}

Based on this evaluation, we recommend ${
    performanceLevel === "Excellent" || performanceLevel === "Good"
      ? "confirming your appointment with the company"
      : "continued probation with further support and guidance to improve performance"
  }.

We appreciate your contribution during this period and encourage you to keep progressing.

Sincerely,
[Your Company’s HR Team]`;

  // Save to localStorage so letter.html can fetch it
  localStorage.setItem("evaluationLetter", letter);

  // Redirect to letter page
  window.location.href = "letter.html";
}


window.addEventListener("DOMContentLoaded", checkPersonalDetails);


</script>